---
title: "Ant Climate Project"
subtitle: "Climatic predictors correlation plots"
author: "Louis Bell-Roberts"
output:
  pdf_document:
    number_sections: true
    fig_caption: true
    includes:  
      in_header: preamble-latex.tex
urlcolor: blue
date: \today
---

\tableofcontents
\newpage 

```{r setup, include=F}
knitr::opts_chunk$set(echo = F, message=F, warning=F, fig.align='center')
knitr::opts_chunk$set(tidy.opts = list(width.cutoff = 60), tidy = T)
# Packages
library(data.table)
library(knitr)
library(ape)
library(ggtree) ## Basic ggplot package for trees
library(ggtreeExtra) ## For fancy tree plotting
library(ufs) ## For ggqq plot
library(phylolm)
library(rr2)
library(ggplot2)
library(ggpubr)
library(tidyverse)
library(tibble)
library(phylopath)
library(phylolm)
library(phytools)
theme_set(theme_minimal())
library(kableExtra)
library(stringr)
# global plotting options for histogram
xmin= -7.5
xmax= 0
```

Read in the ant data and prepare the variables for path analysis (make the appropriate transformations). There are 474 species for which data is available for colony size and climatic variables, excluding special ants.
```{r Read in ant data (global), include=F}
ant_data <- read.csv("/Users/louis.bell-roberts/Documents/DTP_1st_project_rotation/Data/Ant_environment/Subsetted/Primary/Data/CS/New_transformations/AntClm_CSize_all_230710.csv") #After species with unusual biology removed = 474 species

#Square root transform PREavg_avg variable
ant_data$PREavg_avg <- sqrt(ant_data$PREavg_avg)

#Square root transform DTRavg_avg variable
ant_data$DTRavg_avg <- log(ant_data$DTRavg_avg)

#Square root transform TMPsd_avg variable
ant_data$TMPsd_avg <- sqrt(ant_data$TMPsd_avg)

#Log transform PREsd_avg variable
ant_data$PREsd_avg <- log(ant_data$PREsd_avg)
```

# Plot climatic variables against each other to identify correlations
## Using all 474 species (global data)
```{r Plot climatic variables against each other (global dataset), fig.width=10, fig.height=6}
#Rainfall plots
##SD
a<- ggplot(data = ant_data, mapping = aes(x = PREavg_avg, y = PREsd_avg)) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method = "loess") +
    labs( x = "Rainfall average", y= "Rainfall SD")
##CV
b<- ggplot(data = ant_data, mapping = aes(x = PREavg_avg, y = PREsd_avg/PREavg_avg)) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method="loess") +
    labs( x = "Rainfall average", y= "Rainfall CV")

#Temperature
##SD
c<- ggplot(data = ant_data, mapping = aes(x = TMPavg_avg, y = TMPsd_avg)) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method = "loess") +
    labs( x = "Temperature average", y= "Temperature SD")
##SD Kelvin
d<- ggplot(data = ant_data, mapping = aes(x = (TMPavg_avg), y = TMPsd_avg/(TMPavg_avg+273.15))) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method = "loess") +
    labs( x = "Temperature average", y= "Temperature CV (Kelvin)")

#Plot panels
ggarrange(a,b,c,d,nrow=2,ncol=2,labels=c("a","b","c","d"))
```

```{r Read in ant data (regions), include=F}
ant_data_tropical<- read.csv("/Users/louis.bell-roberts/Documents/DTP_1st_project_rotation/Data/Ant_environment/Subsetted/Primary/Data/CS/Tropical_vs_temperate/Tropical_ant_data.csv")
ant_data_temperate<- read.csv("/Users/louis.bell-roberts/Documents/DTP_1st_project_rotation/Data/Ant_environment/Subsetted/Primary/Data/CS/Tropical_vs_temperate/Temperate_ant_data_230804.csv")
ant_data_both<- read.csv("/Users/louis.bell-roberts/Documents/DTP_1st_project_rotation/Data/Ant_environment/Subsetted/Primary/Data/CS/Tropical_vs_temperate/Both_ant_data_230804.csv")

#Square root transform PREavg_avg variable
ant_data_tropical$PREavg_avg <- sqrt(ant_data_tropical$PREavg_avg)
ant_data_temperate$PREavg_avg <- sqrt(ant_data_temperate$PREavg_avg)
ant_data_both$PREavg_avg <- sqrt(ant_data_both$PREavg_avg)

#Square root transform DTRavg_avg variable
ant_data_tropical$DTRavg_avg <- log(ant_data_tropical$DTRavg_avg)
ant_data_temperate$DTRavg_avg <- log(ant_data_temperate$DTRavg_avg)
ant_data_both$DTRavg_avg <- log(ant_data_both$DTRavg_avg)

#Square root transform TMPsd_avg variable
ant_data_tropical$TMPsd_avg <- sqrt(ant_data_tropical$TMPsd_avg)
ant_data_temperate$TMPsd_avg <- sqrt(ant_data_temperate$TMPsd_avg)
ant_data_both$TMPsd_avg <- sqrt(ant_data_both$TMPsd_avg)

#Log transform PREsd_avg variable
ant_data_tropical$PREsd_avg <- log(ant_data_tropical$PREsd_avg)
ant_data_temperate$PREsd_avg <- log(ant_data_temperate$PREsd_avg)
ant_data_both$PREsd_avg <- log(ant_data_both$PREsd_avg)
```

## Using different climatic regions
### Tropical
```{r Plot climatic variables against each other (tropical), fig.width=10, fig.height=6}
#Tropical
##Rainfall plots
###SD
a<- ggplot(data = ant_data_tropical, mapping = aes(x = PREavg_avg, y = PREsd_avg)) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method = "loess") +
    labs( x = "Rainfall average", y= "Rainfall SD")
###CV
b<- ggplot(data = ant_data_tropical, mapping = aes(x = PREavg_avg, y = PREsd_avg/PREavg_avg)) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method="loess") +
    labs( x = "Rainfall average", y= "Rainfall CV")

##Temperature
###SD
c<- ggplot(data = ant_data_tropical, mapping = aes(x = TMPavg_avg, y = TMPsd_avg)) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method = "loess") +
    labs( x = "Temperature average", y= "Temperature SD")
###SD Kelvin
d<- ggplot(data = ant_data_tropical, mapping = aes(x = (TMPavg_avg), y = TMPsd_avg/(TMPavg_avg+273.15))) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method = "loess") +
    labs( x = "Temperature average", y= "Temperature CS (Kelvin)")

#Plot panels
ggarrange(a,b,c,d,nrow=2,ncol=2,labels=c("a","b","c","d"))
```


### Temperate
```{r Plot climatic variables against each other (temperate), fig.width=10, fig.height=6}
#Temperate
##Rainfall plots
###SD
a<- ggplot(data = ant_data_temperate, mapping = aes(x = PREavg_avg, y = PREsd_avg)) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method = "loess") +
    labs( x = "Rainfall average", y= "Rainfall SD")
###CV
b<- ggplot(data = ant_data_temperate, mapping = aes(x = PREavg_avg, y = PREsd_avg/PREavg_avg)) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method="loess") +
    labs( x = "Rainfall average", y= "Rainfall CV")

##Temperature
###SD
c<- ggplot(data = ant_data_temperate, mapping = aes(x = TMPavg_avg, y = TMPsd_avg)) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method = "loess") +
    labs( x = "Temperature average", y= "Temperature SD")
###SD Kelvin
d<- ggplot(data = ant_data_temperate, mapping = aes(x = (TMPavg_avg), y = TMPsd_avg/(TMPavg_avg+273.15))) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method = "loess") +
    labs( x = "Temperature average", y= "Temperature CS (Kelvin)")

#Plot panels
ggarrange(a,b,c,d,nrow=2,ncol=2,labels=c("a","b","c","d"))
```

### Both
```{r Plot climatic variables against each other (both), fig.width=10, fig.height=6}
#Temperate
##Rainfall plots
###SD
a<- ggplot(data = ant_data_both, mapping = aes(x = PREavg_avg, y = PREsd_avg)) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method = "loess") +
    labs( x = "Rainfall average", y= "Rainfall SD")
###CV
b<- ggplot(data = ant_data_both, mapping = aes(x = PREavg_avg, y = PREsd_avg/PREavg_avg)) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method="loess") +
    labs( x = "Rainfall average", y= "Rainfall CV")

##Temperature
###SD
c<- ggplot(data = ant_data_both, mapping = aes(x = TMPavg_avg, y = TMPsd_avg)) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method = "loess") +
    labs( x = "Temperature average", y= "Temperature SD")
###SD Kelvin
d<- ggplot(data = ant_data_both, mapping = aes(x = (TMPavg_avg), y = TMPsd_avg/(TMPavg_avg+273.15))) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method = "loess") +
    labs( x = "Temperature average", y= "Temperature CV (Kelvin)")

#Plot panels
ggarrange(a,b,c,d,nrow=2,ncol=2,labels=c("a","b","c","d"))
```


## Plots of TMPavg vs PREavg, TMPavg vs DTRavg, PREavg vs DTRavg
```{r Plot different climatic variables against each other, fig.width=10, fig.height=6}
#TMPavg vs PREavg
a<- ggplot(data = ant_data_both, mapping = aes(x = PREavg_avg, y = TMPavg_avg)) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method = "loess") +
    labs( x = "Rainfall average", y= "Temperature average")
#TMPavg vs DTRavg
b<- ggplot(data = ant_data_both, mapping = aes(x = DTRavg_avg, y = TMPavg_avg)) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method="loess") +
    labs( x = "DTR average", y= "Temperature average")

#PREavg vs DTRavg
c<- ggplot(data = ant_data_both, mapping = aes(x = PREavg_avg, y = DTRavg_avg)) +
  geom_point(colour = "blue", alpha = 0.2) +
  geom_smooth(method = "loess") +
    labs( x = "Rainfall average", y= "DTR average")

#Plot panels
ggarrange(a,b,c,nrow=2,ncol=2,labels=c("a","b","c"))
```














