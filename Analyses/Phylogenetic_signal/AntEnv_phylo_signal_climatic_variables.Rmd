---
title: "Ant Climate Project"
subtitle: "Estimation of phylogenetic signal in climatic variables using R2"
author: "Louis Bell-Roberts"
output:
  pdf_document:
    number_sections: true
    fig_caption: true
    includes:  
      in_header: preamble-latex.tex #This needs to include the pathway to the .tex file as well if the file is not in the same folder as the markdown script
urlcolor: blue
date: \today
---

\tableofcontents
\newpage 

```{r setup, include=F}
knitr::opts_chunk$set(echo = F, message=F, warning=F)
knitr::opts_chunk$set(tidy.opts = list(width.cutoff = 60), tidy = T)
# Packages
library(data.table)
library(ape)
library(ggtree) ## Basic ggplot package for trees
library(ggtreeExtra) ## For fancy tree plotting
library(ufs) ## For ggqq plot
library(phylolm)
library(rr2)
library(ggplot2)
library(ggpubr)
theme_set(theme_minimal())
library(kableExtra)
library(stringr)
# global plotting options for histogram
xmin= -7.5
xmax= 0
```

# Overview of the document

This document contains PGLS models on climatic variables on all available data (474 species). We calculate phylogenetic signal for each climatic variable (using R2 of the random effect of phylogeny), for each regional scale (global, tropical, temperate and 'both')

Summary

- Tropical: almost no variance explained by phylogeny for any of the climatic variables
- Both: variance explained by phylogeny is much greater for precipitation than any other of the climatic variables. This might explain the model selection results for colony size as the response variable, where temperature and DTR do no improve models much, but precipitation only slightly improves each model compared to the phylogeny-only model.


```{r Transformation-Table}
PartR2<-  c("No", "sqrt", "log (ln)")
table<- rbind(PartR2)
rownames(table)<- NULL
colnames(table)<- c("TMPavg", "PREavg", "DTRavg")
knitr::kable(table, "latex", align= c("c","c","c"), booktabs = T, caption= "Transformation of climatic variables.") %>%
  kable_styling(latex_options = "HOLD_position")
```

# PGLS for full dataset (474 species, no special ants)
```{r read-pgls}
#Read in the R2 summaries for all regions
ptr2_global<- fread("/Users/louis.bell-roberts/Documents/Github/Division-of-labour/Phylogenetic_analysis/Ant_environmental_data/Analyses/Phylogenetic_signal/Outputs/PGLS_global_out_R2.txt")
ptr2_tropical<- fread("/Users/louis.bell-roberts/Documents/Github/Division-of-labour/Phylogenetic_analysis/Ant_environmental_data/Analyses/Phylogenetic_signal/Outputs/PGLS_tropical_out_R2.txt")
ptr2_temperate<- fread("/Users/louis.bell-roberts/Documents/Github/Division-of-labour/Phylogenetic_analysis/Ant_environmental_data/Analyses/Phylogenetic_signal/Outputs/PGLS_temperate_R2.txt")
ptr2_both<- fread("/Users/louis.bell-roberts/Documents/Github/Division-of-labour/Phylogenetic_analysis/Ant_environmental_data/Analyses/Phylogenetic_signal/Outputs/PGLS_both_R2.txt")
```

## Partial R2
### Global
```{r R2-Table-global}
TMP_sig<- c("Temperature", round(mean(ptr2_global$TMP_RandomR2), 3), round(sd(ptr2_global$TMP_RandomR2), 3))
PRE_sig<- c("Precipitation", round(mean(ptr2_global$PRE_RandomR2), 3), round(sd(ptr2_global$PRE_RandomR2), 3))
DTR_sig<- c("DTR", round(mean(ptr2_global$DTR_RandomR2), 3), round(sd(ptr2_global$DTR_RandomR2), 3))

##
table<- rbind(TMP_sig, PRE_sig, DTR_sig)
rownames(table)<- NULL
colnames(table)<- c("Climatic variable","Mean R2", "R2 SD")
knitr::kable(table, "latex", align= c("l","c","c"), booktabs = T, caption= "Partial R2 for the random effect of phylogeny.") %>%
  row_spec(0, bold= T) %>%
  column_spec(1, italic = F) %>%
  kable_styling(latex_options = "HOLD_position")
```

### Tropical
```{r R2-Table-tropical}
TMP_sig<- c("Temperature", round(mean(ptr2_tropical$TMP_RandomR2), 3), round(sd(ptr2_tropical$TMP_RandomR2), 3))
PRE_sig<- c("Precipitation", round(mean(ptr2_tropical$PRE_RandomR2), 3), round(sd(ptr2_tropical$PRE_RandomR2), 3))
DTR_sig<- c("DTR", round(mean(ptr2_tropical$DTR_RandomR2), 3), round(sd(ptr2_tropical$DTR_RandomR2), 3))

##
table<- rbind(TMP_sig, PRE_sig, DTR_sig)
rownames(table)<- NULL
colnames(table)<- c("Climatic variable","Mean R2", "R2 SD")
knitr::kable(table, "latex", align= c("l","c","c"), booktabs = T, caption= "Partial R2 for the random effect of phylogeny.") %>%
  row_spec(0, bold= T) %>%
  column_spec(1, italic = F) %>%
  kable_styling(latex_options = "HOLD_position")
```

### Temperate
```{r R2-Table-temperatel}
TMP_sig<- c("Temperature", round(mean(ptr2_temperate$TMP_RandomR2), 3), round(sd(ptr2_temperate$TMP_RandomR2), 3))
PRE_sig<- c("Precipitation", round(mean(ptr2_temperate$PRE_RandomR2), 3), round(sd(ptr2_temperate$PRE_RandomR2), 3))
DTR_sig<- c("DTR", round(mean(ptr2_temperate$DTR_RandomR2), 3), round(sd(ptr2_temperate$DTR_RandomR2), 3))

##
table<- rbind(TMP_sig, PRE_sig, DTR_sig)
rownames(table)<- NULL
colnames(table)<- c("Climatic variable","Mean R2", "R2 SD")
knitr::kable(table, "latex", align= c("l","c","c"), booktabs = T, caption= "Partial R2 for the random effect of phylogeny.") %>%
  row_spec(0, bold= T) %>%
  column_spec(1, italic = F) %>%
  kable_styling(latex_options = "HOLD_position")
```

### Both
```{r R2-Table-both}
TMP_sig<- c("Temperature", round(mean(ptr2_both$TMP_RandomR2), 3), round(sd(ptr2_both$TMP_RandomR2), 3))
PRE_sig<- c("Precipitation", round(mean(ptr2_both$PRE_RandomR2), 3), round(sd(ptr2_both$PRE_RandomR2), 3))
DTR_sig<- c("DTR", round(mean(ptr2_both$DTR_RandomR2), 3), round(sd(ptr2_both$DTR_RandomR2), 3))

##
table<- rbind(TMP_sig, PRE_sig, DTR_sig)
rownames(table)<- NULL
colnames(table)<- c("Climatic variable","Mean R2", "R2 SD")
knitr::kable(table, "latex", align= c("l","c","c"), booktabs = T, caption= "Partial R2 for the random effect of phylogeny.") %>%
  row_spec(0, bold= T) %>%
  column_spec(1, italic = F) %>%
  kable_styling(latex_options = "HOLD_position")
```







